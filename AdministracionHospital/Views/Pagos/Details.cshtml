@model IEnumerable<AdministracionHospital.Models.PagosModel>

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <h2 class="text-justify"><strong>Consulta de Pagos Pendientes</strong></h2>
    <hr />

    @using (Html.BeginForm("Details", "Pagos", FormMethod.Get))
    {
        <div class="row mb-3">
            <div class="col-md-4">
                <label for="ID_Paciente" class="form-label">Cédula del Paciente:</label>
                <input type="text" name="ID_Paciente" id="ID_Paciente"
                        class="form-control" placeholder="Fromato: x-xxxx-xxxx"
                        value="@ViewBag.ID_PacienteActual" required />
            </div>
            <div class="col-md-8 d-flex align-items-end">
                <button type="submit" class="btn btn-primary me-2">
                    <i class="fas fa-search"></i> Consultar Pendientes
                </button>
                @Html.ActionLink("Regresar", "TotalPagosCliente", "Pagos", null, new { @class = "btn btn-danger" })
            </div>
        </div>
    }

    <hr />

    @if (Model != null)
    {
        <h3 class="bg-warning text-center p-4"><strong>Pagos Pendientes para el Paciente </strong></h3>

        <table class="table table-striped table-hover">
            <thead>
                <tr class="text-center">
                    <th>@Html.DisplayNameFor(model => model.Fecha)</th>
                    <th>Costo del Tratamiento</th>
                    <th>Monto Pagado</th>
                    <th>Saldo Pendiente</th>
                    <th>@Html.DisplayNameFor(model => model.Estado_Pago)</th>
                    <th>@Html.DisplayNameFor(model => model.Tipo_Pago)</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr class="text-center">
                        <td>@Html.DisplayFor(modelItem => item.Fecha)</td>
                        <td>@Html.DisplayFor(modelItem => item.Tratamiento.Costo_Tratamiento)</td> 
                        <td>@Html.DisplayFor(modelItem => item.Monto)</td>
                        <td>@Html.DisplayFor(modelItem => item.Saldo_Pendiente)</td>
                        <td>@Html.DisplayFor(modelItem => item.Estado_Pago)</td>
                        <td>@Html.DisplayFor(modelItem => item.Tipo_Pago)</td>
                    </tr>
                }
            </tbody>
        </table>
    }

    else if (ViewBag.ID_PacienteActual != null && !string.IsNullOrWhiteSpace(ViewBag.ID_PacienteActual))
    {
        <div class="alert alert-success">
            El paciente con ID **@ViewBag.ID_PacienteActual** no tiene pagos pendientes registrados.
        </div>
    }
    else
    {
        <div class="alert alert-info">
            Por favor, ingrese la Cédula del paciente para consultar sus pagos pendientes.
        </div>
    }
</div>